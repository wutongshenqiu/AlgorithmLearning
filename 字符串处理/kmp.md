# KMP[^1]

> 给定一个长度为 $N$ 的字符串 $S$ 和一个长度为 $M$ 的模式串 $P$，求模式串 $P$ 在字符串 $S$ 中所有出现的位置的起始下标
> 
> 假定 $S$ 和 $P$ 的下标以 $1$ 开始

## 从暴力开始

我们将模式串视为一把标尺，在主串上移动，那么暴力的算法实际上相当于每次失配之后将标尺向右移动一位，如下图

![](https://picx1.zhimg.com/80/v2-4fe5612ff13a6286e1a8e50a0b06cd96_1440w.webp?source=1940ef5c)

在暴力比较的过程中，我们已知的信息是已经成功匹配的字符串，如下图

![](https://pic1.zhimg.com/80/v2-7dc61b0836af61e302d9474eeeecfe83_1440w.webp?source=1940ef5c)

那么一种优化的思路就是利用这一段相等的字符串**跳过不可能成功的比较**

## 跳过不可能成功的比较

假设模式串为 abcabd，和主串从 $S[1]$ 处开始匹配，在 $P[6]$ 处失配

![](https://picx1.zhimg.com/80/v2-372dc6c567ba53a1e4559fdb0cb6b206_1440w.webp?source=1940ef5c)

我们现在的已知条件是 $S[1:5] = P[1:5]$，那么 $P$ 应该移动到主串 $S$ 的何处再次进行匹配呢？如下图所示，其需要移动的位置满足 $P[1:5]$ 的后缀要与前缀一致

![](https://pic1.zhimg.com/80/v2-67dd66b86323d3d08f976589cf712a1a_1440w.webp?source=1940ef5c)

# Refs

[^1]: [如何更好地理解和掌握 KMP 算法 -- 阮行止](https://www.zhihu.com/question/21923021/answer/1032665486)
